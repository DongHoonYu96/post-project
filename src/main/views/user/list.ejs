<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../css/memberList.css">
</head>

<body>
<nav class="navbar">
    <a href="/">HELLO. WEB!</a>
    <ul class="nav-item-box">
        <li>
            <button onclick="location.href='/user/list'" class="button BoldS">
                <p>멤버리스트</p>
            </button>
        </li>
        <li>
            <button onclick="location.href='/user/mypage'" class="button BoldS">
                <p>마이페이지</p>
            </button>
        </li>
        <li>
            <button onclick="location.href='/user/logout'" class="button BoldS">
                <p>로그아웃</p>
            </button>
        </li>
    </ul>
</nav>

<section class="hero-box">
    <p class="hero-subtitle">부스트캠프 백엔드 교육용 페이지</h1>
    <h1 class="hero-title">HELLO. WEB! 입니다.</p>
</section>

<section class="board-box">
    <p class="board-count">전체멤버 <span><%=data.total%></span>명</p>
    <ul class="board-list-member" >
        <li class="board-header-member">
            <p class="board-header-nickname BordS">닉네임</p>
            <p class="board-header-email BordS">이메일</p>
            <p class="board-header-createdAt BordS">회원가입일</p>
        </li>
        <% members.forEach(function(member) { %>
            <li class="board-item-member">
                <p class="board-header-nickname BordS"><%= member.nickname %></p>
                <p class="board-header-email BordS"><%= member.email %></p>
                <p class="board-header-createdAt BordS"><%= member.createdAt.toLocaleString() %></p>
            </li>
        <% }); %>
    </ul>

    <%
    function generatePagination(currentPage, totalPages, displayRange = 5) {
        let start = Math.max(1, currentPage - Math.floor(displayRange / 2));
        let end = Math.min(totalPages, start + displayRange - 1);
        start = Math.max(1, end - displayRange + 1);

        let pages = [];
        if (start > 1) {
            pages.push(1);
            if (start > 2) pages.push('...');
        }
        for (let i = start; i <= end; i++) {
            pages.push(i);
        }
        if (end < totalPages) {
            if (end < totalPages - 1) pages.push('...');
            pages.push(totalPages);
        }
        return pages;
    }

    const currentPage = parseInt(curPage.curPage) || 1;
    const totalPages = Math.ceil(data.total / 10);
    const pages = generatePagination(currentPage, totalPages);
    %>

    <nav class="navbar">
        <div class="pagination">
            <% if (currentPage > 1) { %>
                <a href="/user/list?page=<%= currentPage - 1 %>" class="page-link">&laquo; Previous</a>
            <% } %>

            <% pages.forEach(page => { %>
                <% if (page === '...') { %>
                    <span class="page-link">...</span>
                <% } else if (page === currentPage) { %>
                    <span class="page-link current"><%= page %></span>
                <% } else { %>
                    <a href="/user/list?page=<%= page %>" class="page-link"><%= page %></a>
                <% } %>
            <% }); %>

            <% if (currentPage < totalPages) { %>
                <a href="/user/list?page=<%= currentPage + 1 %>" class="page-link">Next &raquo;</a>
            <% } %>
        </div>

        <div class="nav-actions">
            <div class="search-box">
                <input type="text" placeholder="검색어를 입력하세요" class="search-input">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.5 15.5L20 20M10 17a7 7 0 100-14 7 7 0 000 14z"/>
                </svg>
            </div>
            <button onclick="location.href='/post/form'" class="action-button">
                글쓰기
            </button>
        </div>
    </nav>
</body>

</html>